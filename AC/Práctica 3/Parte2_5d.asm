EOI EQU 20H
IMR EQU 21H
INT1 EQU 25H
CONT EQU 10H
COMP EQU 11H
STOP_VALUE EQU 15
ID_INT1 EQU 5

ORG 20
DW SUBRUT_INT1

ORG 1000H
MSJ DB "INTERRUMPIDOOO"
MSJ_FIN DB ?
COMP_VALUE DB 1

ORG 2000H
CLI
  MOV AL, 11111101B
  OUT IMR, AL
  MOV AL, ID_INT1
  OUT INT1, AL
  MOV AL, 0
  OUT CONT, AL
  MOV AL, COMP_VALUE
  OUT COMP, AL
STI
MOV CL, 0

WAIT: CMP CL, STOP_VALUE
JNZ WAIT
INT 0

ORG 3000H
SUBRUT_INT1: PUSH AX
PUSH BX

MOV BX, OFFSET MSJ
MOV AL, OFFSET MSJ_FIN - OFFSET MSJ
INT 7

INC CL

MOV AL, 0
OUT CONT, AL

INC COMP_VALUE
MOV AL, COMP_VALUE
OUT COMP, AL

CMP CL, STOP_VALUE
JNZ SEGUIR
  MOV AL, 0FFH
  OUT IMR, AL

SEGUIR: MOV AL, EOI
OUT EOI, AL
POP AX
POP BX
IRET
END
